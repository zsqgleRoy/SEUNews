import{g as V,A as I,d as R}from"./news-DBmEFlcx.js";import{d as A,r as n,o as P,c as h,f as T,i as t,b as f,Q as j,w as o,p as g,h as s,t as m,u as w,m as H,e as b,E as v,_ as Q}from"./index-CUMlhCnO.js";import{f as U,a as W}from"./format-RLyrj_9i.js";const $={class:"news-list-container"},q={key:0,class:"top-menu"},F={class:"single-line-title"},G=A({__name:"NewsManagement",setup(J){const C=n(window.innerWidth<768),y=H(),i=n([]),u=n(0),d=n(1),_=n(10),l=n([]),p=async()=>{try{const e=await V({page:d.value,pageSize:_.value,status:I.PUBLISH});i.value=e==null?void 0:e.data.content,u.value=e==null?void 0:e.data.totalElements}catch{}};P(()=>{p()});const N=e=>{y.push(`/editNews/${e.id}`)},S=e=>{l.value=e},k=async()=>{if(l.value.length===0){v.warning("请选择要删除的新闻");return}const e=l.value.map(a=>a.id);try{await R(e),i.value=i.value.filter(a=>!e.includes(a.id)),u.value-=e.length,l.value=[],v.success("删除成功")}catch{v.error("删除失败，请稍后重试")}},z=e=>{_.value=e,p()},B=e=>{d.value=e,p()};return(e,a)=>{const D=s("Delete"),x=s("el-icon"),M=s("el-button"),r=s("el-table-column"),E=s("el-table"),L=s("el-pagination");return b(),h("div",$,[C.value?(b(),h("div",q,[t(j),a[0]||(a[0]=f("h1",null,"新闻列表",-1))])):T("",!0),t(M,{type:"danger",onClick:k,disabled:l.value.length===0},{default:o(()=>[t(x,null,{default:o(()=>[t(D)]),_:1}),a[1]||(a[1]=g(" 删除 "))]),_:1},8,["disabled"]),t(E,{data:i.value,onRowClick:N,onSelectionChange:S,"row-key":"id",border:""},{default:o(()=>[t(r,{type:"selection",width:"55"}),t(r,{prop:"title",label:"标题"},{default:o(c=>[f("div",F,m(c.row.title),1)]),_:1}),t(r,{label:"发布日期"},{default:o(c=>[g(m(w(U)(c.row.publishDate)),1)]),_:1}),t(r,{label:"状态"},{default:o(c=>[g(m(w(W)(c.row.status)),1)]),_:1})]),_:1},8,["data"]),t(L,{onSizeChange:z,onCurrentChange:B,"current-page":d.value,"page-sizes":[10,20,50],"page-size":_.value,layout:"total, sizes, prev, pager, next, jumper",total:u.value},null,8,["current-page","page-size","total"])])}}}),Y=Q(G,[["__scopeId","data-v-a95cf8d6"]]);export{Y as default};
