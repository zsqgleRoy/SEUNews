import{d as g,r as d,o as v,E as r,G as f,H as D,m as E,_ as B,h as _,c as a,e as n,b as m,f as C,i as u,w as i,p as y}from"./index-CUMlhCnO.js";const h=g({setup(){const t=d("error"),e=d(!0),c=E(),l=async o=>{if(!o){r.error("支付结果无效");return}try{(await f.get(`${D.SERVER_URL}/api/pay/verify`,{params:{outTradeNo:o}})).data.success?(r.success("支付成功！"),t.value="success"):r.error("支付失败，请重试")}catch(s){r.warning("支付结果验证失败，请联系客服"),f.isAxiosError(s)?s.response?r.error(`支付结果验证失败，状态码：${s.response.status}`):s.request&&r.error("支付结果验证失败，未收到服务器响应"):s instanceof Error&&r.error(`支付结果验证失败: ${s.message}`)}},p=()=>{const o=window.location.hash.split("?")[1];return new URLSearchParams(o)};return v(async()=>{const s=p().get("out_trade_no");await l(s),e.value=!1}),{isLoading:e,status:t,goBack:()=>{c.push("/")}}}}),F={class:"payment-result"},w={key:0,class:"loading-spinner"},R={key:1,class:"result-container"},$={key:0},b={key:1};function L(t,e,c,l,p,k){const o=_("el-button"),s=_("el-result");return n(),a("div",F,[t.isLoading?(n(),a("div",w,e[0]||(e[0]=[m("div",{class:"spinner"},null,-1),m("p",null,"加载中...",-1)]))):(n(),a("div",R,[t.status==="success"?(n(),a("div",$,[u(s,{icon:"success",title:"支付成功","sub-title":"感谢您的支持"},{extra:i(()=>[u(o,{type:"primary",onClick:t.goBack},{default:i(()=>e[1]||(e[1]=[y("返回")])),_:1},8,["onClick"])]),_:1})])):t.status==="error"?(n(),a("div",b,[u(s,{icon:"error",title:"支付失败","sub-title":"请重试或联系客服"},{extra:i(()=>[u(o,{type:"primary",onClick:t.goBack},{default:i(()=>e[2]||(e[2]=[y("返回")])),_:1},8,["onClick"])]),_:1})])):C("",!0)]))])}const x=B(h,[["render",L],["__scopeId","data-v-e8ff79cb"]]);export{x as default};
